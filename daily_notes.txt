6/7/2020
-ROS summer school - Monday
-Lit survey discussion Wednesday
-Drone Weekend - Next monday

10/7/2020
Day 5 merging into Day 4 code is causing issues. 
Need to do again. Some code is currently present (in comment). Needs to be fine tuned. Check if the gazebo part needs to be included within the <robot> node.

Day 6, Hector_Slam not working. Possibly the linking of packages maybe causing an issue.


17/7/2020
For any package installation on melodic, use the following format:-

sudo apt-get install ros-melodic-<package_name>

20/7/2020
Plan this week:-
-Game theory paper for USV
-Distributed MPC
-Drone workshop
-Navigation ROS

21/7/2020
-beta, build folders are getting created outside the catkin_ws when cloninng from old link or new link (strange).
Initially px4 not working but spawn service working (catkin_ws_beta). Copied the devel folder to the workspace and now px4 working but not spaw service (catkin_ws).

-It is hector-slam and hector-mapping

-If Gazebo is not working, then its possible that another gzserver or gzclient is open.
Close this using command here (https://answers.gazebosim.org//question/9170/error-while-loading-gazebo/)

https://github.com/topics/swarm-robotics
https://github.com/yxiao1996/SwarmSim

22/7/2020
- In the devel folder, copied the px4 package. Started working fine.
- Tasks
	- Make one robot navigate autonomously around one of the world maps
	- Make multiple robots navigate around the world maps 
	- Communicate position information amongst the robots
	
px4 is not able to build all packages when catkin build is entered.
Try to remove all packages and then install using the bash script instead.

23/7/2020
The package my_robot_name_2dnav guves a template useful to setup the navigation stack, according to http://wiki.ros.org/navigation/Tutorials/RobotSetup

navigation tutorials require the use of a joystick. Need to search for a solution that uses a joystick driver. - can use mb_3. But not as useful for the final aim, as navigation takes an existing map.
link the pcl and camera node programs in order to autonomously move the tutorial specified URDF robots.
Was able to hange the topic that turtlbot3 subscribes to. Need to check behaviour of the bot with smaller values (+2, -2 on /turtle1/cmd_vel is too fast)  - Done, 0.5 working well.
 
 Next tasks:-
 Need to add a PCL node onto the URDF robot and test its working as an autonomous agent driving around the track.
 Add another URDF bot and let it drive autonomously too.
 Write the distributed controller algorithm on each bot.
 Stitch the maps generated by each bot 
 
27/07/2020
line to run the rqt_graph
rosrun rqt_graph rqt_graph

To display the messgae type of a topic
rostopic type <topic_name> 

28/07/2020
rrt_explorations can be used for single robot case and combined with a navigation stack based mobile robot.
http://wiki.ros.org/rrt_exploration/Tutorials

Need to understand why map to other frame conversions are not happening.


29/07/2020
Command that makes map appear in fixed frame of rviz:-
rosrun tf static_transform_publisher 0.0 0.0 0.0 0.0 0.0 0.0 map my_frame 100

Getting error Fixed Frame [map] does not exist. No transformation between /map and URDF defined robots.
Works OK for hector_slam and gmaping but amcl is the problem.

AMCL relies on he transformation between odom and map. odom can only come when there is gazebo that is launched!
Created keyboard_amcl_control.launch for this.

30/7/2020
amcl robot keeps jumping around the arena. This does not seem right..

According to (https://answers.ros.org/question/323723/how-to-publish-a-map-frame/) it better to use cartographer
https://google-cartographer-ros.readthedocs.io/en/latest/

mapping is giving problems in rrt_tutorials
amcl node is giving problmes in localisation 
In navigation, movement of robot to desired point not happening. (Aim is to be able to do this https://www.youtube.com/watch?v=orYNS6ntjnY)
	-Control loop missing desired rate issue
	-Varied frequency b/w 0 to 20. Didnt help. 
	
Plan now, try amcl and navigaion but also generate a dynamic real-time map on the topic \map that robot will be making. As done in https://www.youtube.com/watch?v=OZ_-jAtGyZQ.

global plan error (https://answers.ros.org/question/304537/could-not-transform-the-global-plan-to-the-frame-of-the-controller/)


Control loop missing desired rate issue is coming for all the cases:-
	- hector_slam mapping map
	- gmaapping map 
	- amcl localisation 

Need to check if the code works on others laptop. [CRITICAL] -> Issue was that bot was not subscribing to cmd_vel and hence not working. Also Keep the paramters as per (http://zdome.net/wiki/index.php/Navigation_Tuning) in order to ensure it moves around.

31/7/2020
In amcl:-
	1) The movement is good when obsctale us present. When taking turns, then it warns that no trajectory is possible.  

In gmaapping map:-
	1) Only applied the cmd_vel modifications and kept the default values of parameters
	2) Found that the planning and moving to the target is better than amcl case
    3) The Control loop missing desired rate issue still comes.
	4) Changed paramters as per above link, the map building process is slower. The path planning is slower. The Control loop missing desired rate issue still comes at times (lesser number of ocurrances though) 
	5) AMCL does not work seem to work with dynamic maps. It gives a request for map failed error even if map is being sent on the /map topic

In hector_slam case:-	
	1) Only applied the cmd_vel modifications and kept the default values of parameters
	2) Found that the planning and moving to the target is better than amcl case and gmapping case
    3) The Control loop missing desired rate issue still comes.
	4) Changed paramters as per above link, the map building process is OK and more stable than gmapping (visually). The Control loop missing desired rate issue still comes
	
From gmapping the message type of \map is nav_msgs/OccupancyGrid
From amcl case, the message type of \map nav_msgs/OccupancyGrid

https://answers.ros.org/question/337981/ros-amcl-path-planning-with-live-gmapping-map/
-Can be useful

When setting goals,
1) initially, when a goal outside the map is selected then the a global path is generated in the map. If the robot cannot move to that path then it gives out a failed to create path error. When user gives another path, which is inside the map, a fresh new path is generated and the robot travels to the goal position. 
2) After sometime, when the map is built, a goal outside the map is not taken by the robot and only points within the map boundaries is considered.

Need to figure out a way to:-
1) Dynamically create goal points for navigation and thus exploration.
2) Do pose estimation

http://wiki.ros.org/nav2d
http://wiki.ros.org/navigation/Tutorials/SendingSimpleGoals - Possibly randomise this in some way.

3/8/2020
Able to assign goals. Able to send goals but it gets stuck in certain points mny times. Possibly, using the camera input can remove this?
In most maps, the part where it gets stuck is when an object comes in front of the agent and it gets stuck (unable to move even when rotating at times)

Multiple bot is running for the normal case of spawing it into the gazebo arena. When combined with the navigation stack, it is giving an error. 

To check based on this :- 

https://answers.ros.org/question/41433/multiple-robots-simulation-and-navigation/

https://www.theconstructsim.com/ros-qa-130-how-to-launch-multiple-robots-in-gazebo-simulator/

Need to read on coordinatino strategies and enable them for 2 robots.

4/8/2020
-Goal Generation at 1m ahead from the base_link frame helps in the exploration task. However it tends to give very random behaviour of sometimes wokring and sometimes not (Many times gets stuck at some point)

Naviation:-
	- Mapping
	- Localise
	- Path Planning
	- Obstacle Avoidance

Move_base node:-
	- Rotate recovery is a package that is present in this node 

-In the case of drones, possibly instead of using the laser data, a combination of the camera and extended kalman filter (as done here https://jakobengel.github.io/pdf/engel12iros.pdf) can be used to get the state and enable navigation.

-Keep exploring the area, once map has been developed upto a certain extend, then divide the area into n (number of robots) regions and assign a robot to each region. (http://wiki.ros.org/rotate_recovery)

https://www.techbriefs.com/component/content/article/tb/stories/blog/35522

wiki.ros.org/global_planner - For global planner, uses Dijkstras or A* algorithm
http://wiki.ros.org/costmap_2d - Uses costmaps around the abstacles to detect a collision-free path.
http://wiki.ros.org/base_local_planner - Uses Trajectory rollout or dynamic window approach (DWA) (DWA is recommended)
http://wiki.ros.org/teb_local_planner - Trajectory elastic band. A sparse scalarized multi-objective optimization problem is solved. Initial trajectory generated by global planner is optimised during runtime wrt min exec time, obstacle seperation, kinodynamics constraints.

TBD:
With navigation, map to other tranformation error is coming. - only spawning working OK, navigation TBD [critical]

A* seems to be faster than dijstra's according to https://www.youtube.com/watch?v=RYdBcnSiwag (Serches along manhattan/non-diagnol grid blocks)

http://wiki.ros.org/nav2d seems to also be useful, only problem is uses joystick for tutorials.
https://www.youtube.com/watch?v=n6RjVbh3Vgc also seems useful

Once [critical] done, see game theory control algorithms and how to use a navigation stack using only camera and odometry information as in the TU Munich videos.

5/8/2020
amcl nodes are still giving an error, map is displayed but the rviz says fixed_frame map does not exist!! How??
When the use_sim_time parameter is added (is made true) then the node does not even detect the map.

Tried following this, but getting different results (https://www.youtube.com/watch?v=es_rQmlgndQ)

TBD:
Multiple navigation stack agent spawning [critical]

6/8/2020
When only move_base1 is launched, then the hector_slam node is publishing values but move_base1 is not subscribing to it.

To continue reading this Hernandez_Game_Theory_Models_Int_J_Adv_Rob_Sy_2013_10_181.pdf . Looks good as:-
-> decentralised
-> game-theory
-> non-deterministic path patroling (Can possibly be used in exploration) 

7/8/2020
Seperate map topics are possible by grouping nodes into a single group. Due to this /robot1/map and /robot2/map are generated, but a combined /map and hence the topic to display called map is unable to be displayed. 

The /map was not being sent due to this the robots had no way of having a transformation between one another (and the common map). By putting the following in the launch files, uit started to work.

<node pkg="tf" type="static_transform_publisher" name="odom_map_broadcaster_robot1" args="0 0 0 0 0 0 map robot1_tf/odom 100"/>
<node pkg="tf" type="static_transform_publisher" name="odom_map_broadcaster_robot1" args="0 0 0 0 0 0 map robot2_tf/odom 100"/>

ToDo:-
AMCL looks to be working. Need to now stich individual laser scans, combine and make the overall map!
/robot1/cmd_vel and /robot2/cmd_vel are working okay. Therefore, the coordination can be worked on.
/robto1/move_base_simple/goal are not working, So giving goals is not going to work until its solved. (Possible this video (https://www.youtube.com/watch?v=G_RhKZUQCkc) may help. 
)


10/8/2020
-Global planner Analysis

-Package frontier exploration as given in https://rds.theconstructsim.com/r/husarion/search_object_in_unknown_environment_1/ available only for kinetic. Need to check melodic compatible version.

Every robot needs to publish the map in a different topic and also in a different global frame 

robot1/map being produced but not robot1_tf/map by the hector slam node. Need to enable this.

move_base_simple/goal not wroking still.

Nesting the move_base within the robot group, The topic is appearing in rostopic list, but the tf transform is not happening. [critical]
robot1/map not happening [critical]

11/8/2020 - 12/8/2020

https://www.youtube.com/watch?v=vR1fNo4UDG4&list=ULcEWnixjNdzs&index=125

Step tried:- 
1) Try generating a hector_map map output data using only one robot on the topic robot1_tf/map
	- Placed hector map launch inside the group robot1, 
		-No map or robot1_tf/map. 
		-Error - base_link to robot1_tf/laser timed out - appeared.
	- Placed hector map launch outside any group and within nav_robots. 
		-No map in tf_view. 
		-No error - base_link to robot1_tf/laser timed out
	- Changed frames to /robot1_tf/map, /robot1_tf/base_link, /robot1_tf/odom in hector slam. Placed hector map inside group 1.
		- No tf1_frame present on the global fixed frame
		- Only name vhanges, but still no occurence of map or robot1/map in the tf graph.
	- Added the line  <node pkg="tf" type="static_transform_publisher" name="odom_map_broadcaster_robot1" args="0 0 0 0 0 0 robot1_tf/map robot1_tf/odom 100"/>. 
		- robot1_tf/map appears on the frame but is generated by the node that was made. Instead the frame needs to be generated by the hector_slam node.
	- Changed base_frame to robot1_tf/base_footprint. 
		- No appearance of robot1_tf/map still.
	- Used a remap map to robot1_tf/map
	    - The topic robot1/robot1_tf/map appears. This means that the topic is getting remapped with remap command
		- The tf robot1_tf/map still does not occur.
	- In the single aut exploration launch (autexpl_hector_slam.launch), map is removed
		- map is still present in the tf graph but there is a degraded behaviour
	- Replaced hector_mapping with gmapping.
		- map appears in the fixed frame
		- map is seperatley linked to odom.
	- Changed odom frame to robot1_tf/odom
		-map is able to link to robot1_tf/odom in tf
	- Changed base_frame to robot1_tf/base_footprint
		-robot1_tf/map to map error coming
		-map is able to link to robot1_tf/odom in tf graph
		-map data is present on robot1/map
	- Changed map_frame to robot1_tf/map
		- The error "No Transform from [robot1_tf/robot1_tf/map] to [robot1_tf/map]" appears
		- robot1_tf/map is able to link to robot1_tf/odom in tf graph
	- Added a robot1/scan as the topic to get the the laser scans from.
		- Same as above
	- Placed the include outside the group 1.
		- No robot1/map topic anymore
		- robot1_tf/map still exists in the tf graph. ( What's the relation between robot1/map and robot1_tf/map? )
	- Changed robot1_tf/map to map in. include gmapping outside the group
		- No data present on /map topic. No map recieved error occcuring.
		- tf has /map present in it
	- Removed the robot1/scan value from the topic scan. 
		- Still same error ie.
		- No data present on /map topic. No map recieved error occcuring.
		- tf has /map present in it
		

2) Try to enable robot1/cmd_vel get velocity commands based on robot1/move_base_simple/goal topic
	- In AMCL, /map is not generated spantaneously. 
	- Seperate AMCL files having different name_space resolved targets used and map as a fixed frame appears	
		- base_footprint frame error comes. Possibly tranforms need to be canged there too.

TBD-		
- To change the values of the tb3_description and check with keyboard control.
- Make a comparison and selection of distributed algorithms

13/8/2020 -
- When include files are placed within the group, the topics change but the tf changeis arbitrary.
- Both bots are present on rviz. Errors:-
	- Invalid argument "/map" passed to lookupTransform argument target_frame in tf2 frame_ids cannot start with a '/' like:
	- Not sure how to send robot1/move_base_simple/goal and robot2/move_base_simple/goal.

- To test algorithms, this can be used https://github.com/AtsushiSakai/PythonRobotics

- Can be useful (https://wiki.nps.edu/pages/viewpage.action?pageId=1163463250)

-TF names is sensitive to / 

14/8/20
-Read Robot Motion and Planning notes on multi robot planning.  
 -RRT Exploration package-
	-Navigation stack, GMApping, Laser Scanner needed.
	-Global/Local/OpenCV Frontier Detector (RRT based Frontier detector) -> Frontier Filter -> Target location/Goal Assigner 
		- Global detector can be the base ocarrying the drones. 
		- The local detector can be the drones. 
	- Questions -
		- How are frontiers detected?
		- How does Assigner send out goals? (Possibly game theory applied here?)
- launch files as mentioned ifor the tutorial package not working. The tf between gazebo and rviz is disjoint. The errors  E: Unable to locate package ros-melodic-kobuki-gazebo and ros-melodic-kobuki maybe causing this.
- Used my own robot.
	- Make rrt_exploration work with the Land based bot
	
Facing the same issue as this https://github.com/hasauino/rrt_exploration_tutorials/issues/1 + ""Waiting for robot transform" error. Need to check 

17/8/2020
- Frontier detection seems to be happening
- There is a custom topic in a PointArray.msg file which is not getting loaded. Followinfg error is coming when running rostopic echo /filtered_points
rostopic echo /filtered_points
^[[DERROR: Cannot load message class for [rrt_exploration/PointArray]. Are your messages built?

https://www.cvxpy.org/index.html

Algorithm comparison need to be made.

https://github.com/bgheneti/MultiboatTrajectoryOptimization

https://www.toptal.com/robotics/programming-a-robot-an-introductory-tutorial 
	- Another program can be used to give goals. Possibly the simulatior can be used for multiple robots which is fed with a game-theory based goal allocator.
	- Uses python 2.7. Uses gui.frame. Not available.
- Make a simulator to launch multiple bots onto.

18/8/2020
- Ruslan Agishev Project - 
	- Uses adaptive swarm to firts plana global path using RRT. Subsequent to this an APF method ensures that trajectories are collision free
	- Advantage, 
		- Different types of analysis techniques are present
		- RRT algorithm used, can be combined with the frontier exploration ebinig done on ROS
		- Considers moving obstacles 
		- Simulation neat and simple
		- Has been used with the crazyfiles 2.0 robots through ROS
	- Disadvantage
		- Leader- Follower
		- Only one goal is generated
		- Assumes a pre-existing map
		- Python 2.7 
-motion planning project -
    - random_goals_following.py can possibly be used
		- Multiple bots 
		- Collision avoidance feature is present

-Game theory multi-robot control-
	-Evolutionary game theory. Projection and replication dynamics equation.
		- Population dynamics
	-2 steps-
		- Distributed algorithms of projection and replicator dynamics applied to generate ideal trajectories that lead each agent to a common destination point.
		- Algorithm modified so that agents position themselves in particular formations in space (triangle, square etc)
	- Potential function Function
	- Revision protocol (rho) - denote policies in order to adapt to environment.

Issues:	
- Multiple robotic exploration happens in an exitsing map only. Performing many GMapping is causing an error.
- RRT Frontier detection and movent is not working because a particular message type is not being created.
- How to assign the goals to each robot via game theory? Should it be something like "As far apart but within the boundary region provided?"
		
Autonomous multiple gmaping -
- Request for map failed; trying again... Error is coming.
- Removed the amcl node 
	- No tmap messgaes are being published on the /robot1/map topic from gmapping.
- Used the param map and assigned it to robot1/map
- Waiting for the robot2/move_base action server to come up error - gets removed if the map tf frame appears.
- gampping expects data from scan. Need to check how to change
- The map merging in the topic is happening, but the tf2 of /map is not getting generated. Possiibly this may help (https://www.youtube.com/watch?v=SWjVgd9a2Z8) - used a static map transform. 

19/8/2020
Only robot2/map is getting displayed.

Need to try and do this https://answers.ros.org/question/9747/how-can-i-speed-up-simulation-in-gazebo/

20/8/2020
world_frame is not working. So Need to give a static transform. Need to check if this is expected.

In multiple RRT case, /detected points not getting values. /filtered_points not getting built.

Need to check this error for single bot.
Error still coming.

Can also try frontier exploration. 

21/8/2020
Using rrt_exploration_tutorials rviz file makes the thing work (strange) .

To be done-
- Improve the merged map. Possibilities:-
	- AMCL
	- Map Merging parameters
	- GMapping parameters

24/8/2020
-For frontier detection - http://wiki.ros.org/explore_lite
-Map Quality improvement did not work. Need to check the parameters of this https://www.youtube.com/watch?v=G_RhKZUQCkc&t=1519s and update it.

25/8/2020
No map tf generated by map_merge Issue
- Changed world_frame to /map
	-NOK
- Kept known_init_frames = false
	-NOK
	- Added robot_map_updates = map_updates
		-NOK
	- Modifed to robot_map_updates = map
		-NOK
	- Modifed to world_frame = robot1_tf/map
		-NOK
	- robot_map_updates = map_updates and world_frame = robot1_tf/map
		-NOK
	- Added /use_sim_time=true
		-NOK

New links - 

You
10:16 AM
https://www.youtube.com/watch?v=G_RhKZUQCkc&t=1519s
Ludo Stellingwerff
10:19 AM
http://wiki.ros.org/amcl
Réka Bérci-Hajnovics
10:44 AM
https://google-cartographer-ros.readthedocs.io/en/latest/going_further.html#multi-trajectories-slam
Réka Bérci-Hajnovics
10:47 AM
https://www.youtube.com/watch?v=RaYbFUHLEAU
Réka Bérci-Hajnovics
10:55 AM
https://google-cartographer.readthedocs.io/en/latest/
Snehal Jauhri
11:00 AM
https://github.com/SteveMacenski/slam_toolbox
You
11:06 AM
https://www.fransoliehoek.net/wp/

Cartographer - 

TBD:- Cartographer
https://google-cartographer.readthedocs.io/en/latest/index.html
https://www.youtube.com/watch?v=bXNK8VTQ4zo

TO Check, Can it be used for multirobot case? If multi_robot_merge needed then need to debug previous map TF Issue.

26/8/2020
-Cartographer
	-local SLAM (frontend)
		-Used to build a succession of submaps
	-global SLAM (backend)
		-Used to find loop closure constraints by scan-matching scans
	-bandpass filter-
		- Only keeps range values between a certain min and max range

https://ouster.com/blog/building-maps-using-google-cartographer-and-the-os1-lidar-sensor/

Cartographer -
	-cartographer_node does the computations and cartographer_occupancy_grid_node gives out the grid_map
	-  CeresScanMatcher and RealTimeCorrelativeScanMatcher possible scan matchers.
		- RealTimeCorrelativeScanMatcher is expensive but robust
	- Issues:- 
	-	1) When running the robot on a straight path, then the mapping algorithms starts to join regions and smudges the map.
		2) Wehn navigation goals is given, then the robot moves on another path than what's given.
		- tracking_frame = base_footprint and published_frame = base_footprint without AMCL is giving erroneous results
		- When putting AMCL, the error sustains
		- For smaller maps, the map building while exploring is OK. For larger maps, the bahiour decreases in quality. Need to Check paramters.
		- Changed tracking_frame = imu_link
			- Issue still there
		- tracking_frame = base_footprint and kept TRAJECTORY_BUILDER_2D.max_range = 2.0
			-The sensing of the region worsens
		- Reverted to max_range = 4. Added TRAJECTORY_BUILDER_2D.real_time_correlative_scan_matcher.angular_search_window = math.rad(35)
			-Same Issue 
		- THE ISSUE 1) HAPPENS WITH GMAPPING ALSO.
		- removed the max_range=4
			-ISSUE 1) is Solved! removing the max_range removes the error.
			-ISSUE 2) Still persists.
		- Issue 2) does not happen in G-Mapping
		- Modified use_imu_data = true 
			- Map does not even come!
		- Removed translation_delta_cost_weight=e-1.
			-ISSUE 2) Still persists.
		- Removed rotation_delta_cost_weight=e-1
			-ISSUE 2) Still persists.
		- Modified tracking_frame = "imu_link"
			-ISSUE 2) Still persists.
			-The robot model looks partial in the map.
		- Modified min_range = 1
		
		
	TBD:-
	-Cartographer and the navigation stack not working a s per intuition. When goal give, then car move somehwere else.
	
27/8/2020
1) When the map moves around an axis, it causes a distortion in the map.
1) -Issue 2 debugging:-
	-Modified to  published_frame = "base_footprint"
		- ISSUE 3 - There is a diiffererence in what laser scan sees and the map being build.
		- Poor robot localisation (position keeps shifting)
	-Modified to  published_frame = "odom"
		- Issue 2 is solved.
		- Issue 3 still persists
		- ISSUE 4 - [Error]Ignoring transform from authority "unknown_publisher" with frame_id and child_frame_id  "odom" because they are the same
	- Modified tracking_frame = "imu_link"
		- Issue 3, 4 still persists
	- Checking if issue happens in arena_2018.wolrd also.
		- Same Issue
	- Modified provide_odom_frame = "false"
		- Issue 3 and Issue 4 resolved
		- ISSUE 5 - [error] The goal pose passed to this planner must be in the map frame.  It is instead in the base_link frame.
	- Added a goal wirth respect to map frame.
		- When a goal outside the boundary is given, then if we increment and give goals, then the goals will go outside the arena.
		- Therefore in the final version we can give the postion of the goal wrt the map postion, but oly as an absolute value.
	- Incremented the sleep time to 10 seconds. 
		- Better performance 
TBD
/scan is being taken by each robot. Need to check how to make it take indivual robot1/scan and robot2/scan.

28/8/2020 - 
ISSUE 6 - map merging not happening
ISSUE 7 - Unconnected TF's on Gazebo 
1) Set seperate lua scripts with different scan values
	- ISSUE 6 and ISSUE 7 persists
2) Set num_laser_scans = 2. Included only 1 .lua file.
	- ISSUE 6 and ISSUE 7 persists
	- ISSUE 8 - odom frame does not appear.
3)  Added 2 remaps from scan to robot1/scan and robot2/scan 
	- ISSUE 6 and ISSUE 7 persists
4) Set seperate lua scripts with different scan values, to check if ISSUE 8 gets resolved.
	- ISSUE 6,7,and 8 persists
5) Changed each robot odom fram to include tf namespace.
	-ISSUE 6,7,and 8 persists
6) Removed scan topics
	-ISSUE 6,7,and 8 persists
7) Remapped from robot1/scan and robot2/scan to /scan
	-ISSUE 6,7,and 8 persists
8) Observation -> When Gmapping with only 1 node is used then no odom is shown on screen but only difference between working and not wokring is the robot1/scan  and robot2/scan are taken as input by the SLAM algorithms, HOW TO DO THIS IN CRTOGRAPHER?? 
9) Added a remapping from scan_1 and scan_2 to robot1/scan and robot2/scan. Used the single Cartographer file.
	- Cartographer nodes able to get robot2/scan and robot1/scan topics
	- No "base_link" error coming
10) made tracking_fram = robot1_tf/base_link in summit.lua
	- Issue 6, 7 8 happening
11) Modified tracking_frame = map
	- Issue 6, 7 8 happening
12) Modified tracking_frame = map and a static frame of the map connected to the map
	- Issue 6, 7 and 8 get solved
	- BASICALLY MAP FRAME NEED TO BE GENERSTED THAT IS CONNECTED TO ODOM.
13) Made seperate summit files and added them to the launch file bu using a tatic transform
	- The TF is OK, but map is pooor
	-Important to note, that the /map generated topic in seperate case does not need a map merge.
	-Merging looks okay, bu the map keeps refresshing slowly.
	
TBD, solidy the merging and ensure a confident result
	
Thesis discussion
- Literature study to be longer
- Many points are too specefic especially the graphical planning
- Many questions are too specefic at this stage

- Add more papers related to the terms Decentralised, Planning and Exploration. This need to be put in the starting of the overleaf file


31/8/2020 -
To also check 3D mapping for the single robot case and increase it to multiple robots.
1) Launched cartograph node calling seperate map cartographers for each robot -
	- ISSUE 9 - Map keeps refreshing,
	- ISSUE 10 - Laser scans of each robot is different. Ideally should be same as they are in the same arena.
	- ISSUE 11 - Both robots spawned on the same point
2) Changed map_frame of each robot to /map.
	- Issues persist
3) Changes published_frame=odom
	- Issue 7 comes up. No bots, but only map present on Gazebo

1/9/2020
In both map merging and carto, no dynamic tf of map is generated (ISSUE6)	
ISSUE 9, 10 and 11 dont happen in Map-Merger. But ISSUE 6 happens there too.

So, Starting to Debug map-merger first.
	- Tried as per video by placing a tf map between tf1 and tf2, did not work
	- To note, No difference happens between world_frame=robot1_tf/map and  world_frame=map (while keeping map frame static)
	- When both the init pose and the spawned points are equal, then ISSUE 10 gets resolved in Map-Merging.
	- ISSUE 12 - Whenever, the maps are merged from map-merger, then the map appears shifted from the laser scans (or what is seen by the robot.
		- By having a +0.5 shift in both X and Y axes of the, ISSUE 12 gets Resolved.
		-map merge appears to be shifted by 0.5 from each individual map.
		
Tried doing 3D mapping. Required tuning of more parameters.(Need to read after merging 2D maps)

Assigning provide_odom_frame  = true removes ISSUE 10 in case of Cartographer. This also removes ISSUE 11. ISSUE 9 still present.
	- ISSUE 13 - map only consistd one fo the mps (specefically map 2)
To solve ISSUE 12, need to find how to offset the map.


TBD-
1) RRT Exploration and frontier detection start.
2) Map merging using a cartographer. - ISSUE 13, ISSUE 12
3) 3D map merging using a cartographer.

02/09/2020
For RRT Exploration related work, launch:-
roslaunch multi_robot nav_tut_gmapping.launch

roslaunch rrt_exploration simple.launch

ISSUE 14 - Single robot not able to move around arena
1) Modified SimpleActionClient to have = self.name+'/move_base' 
	- ISSUE 14 Persists
2) Modified
	- ISSUE 15 - /filtered_points message class not loaded
	- RQT Graph as expected (compared to periodic gmapping)
	- As /filtered_points not coming, 
	- Run devel and then ISSUE 15 works.

03/09/2020
move_base/goal is what the navigation robot which is given goals via the action API.

To Try, 

04/09/2020
- When launching single.launch from the tutorials:-
	1) ISSUE 16 - No Tf betwwen robot1_odom and robot1_base_footprint
- On placing a static tranform between above 2 TF's, then error comes:-
	1) ISSUE 17 - goal pose passed to this planner must be in robot_1/map frame and not /robot_1/map frame

- When using single.launch, the global costmap is not getting detected.
-  With simple launch, the goals still not getting generated by assigner :(

- As Frontier is still getting detected, What can be done is the centroid position of it can be used as a goal for a single robot. Robot can then move to this.
- For multi-robot case, many centroids can be detected and each robot can go to a particular goal postion.

To try frontier_detections and explore_lite.
The launch file for explore_lite not working :(

Install PX4 and then this package -> For 2D mapping with drones - https://www.wilselby.com/research/ros-integration/2d-mapping-navigation/

Need to Check Assigner node of rrt_Exploration and manually send goals to 1 robot (Without the MRTA)

08/09/2020
explore_lite package is not available for ROS Melodic. Due 

Frontier exploration with husky - Vague term, 
Use the Point tool in the top toolbar to draw a closed polygon on the map that the Husky should explore. Watch the terminal window for instructions. 
What Point tool? what terminal window?

rrt_exploration package still not generating the desired goals.
	- Ran manually and did not find map detection issues.
	- Need to somehow get this working at it looks most promising.

FunctionsendGoal never gets entered into 

9/9/2020
Filter published topics:-
frontiers (visualization_msgs/Marker)
	-The topic on which the filter node publishes the received frontier points for visualiztion on Rviz.
centroids (visualization_msgs/Marker)
	-The topic on which the filter node publishes only the filtered frontier points for visualiztion on Rviz.
filtered_points (invalid message type for MsgLink(msg/type))
	-All the filtered points are sent as an array of points to the assigner node on this topic.

In simple_assigner, The frontiers are getting appended in callBack.

Line 82 of simple_asigner is the problem. The code gets stuck here. Need to check the init of robot class.


10/9/2020
ISSUE 14
Cause -The line rospy.wait_for_service(self.name+self.plan_service) waits continuosly and does not let the program flow.
Solving - Remove the line (OK)
			  Change the plan_service string (NOK)
				- Changed the base planner of the nav core( http://wiki.ros.org/nav_core ) to the faster global_planner which is used in the description for the robot defined.
				

ROS Service
	-Needed for Dsitributed computing
	-Only 1 time, client requests service. Service sends a response to the client. THis is in contrast to subsriber-publisher communication paradigm
	-Remote Procedure call (RPC)

ISSUE 18 - A constant goal is assigned after a point. This cases only rotate recovery to occur.

ISSUE 19 - The RRT algorithm appears to be invariant to robot orientation. Only considers the position of it.

ISSUE 20 - Map merging not working. Package path not found.
					-The m-explore package needs to be present in the workspace for merging to work
					- This is because melodic release of multiple map merge is not installable from the sudo command

Map Merging works and single RRT Exploration works (except ISSUE 18). Multiple working requires some fine tuning.

In multiple robot case, detected points are working, but filtered points are not working. Due to this no goals and thus no movement.
To Check

11/9/2020
ISSUE 21 -
When the TEB local planner fails to get a plan, then the robot gets stuck on one of the edges.
It appears that rotate recovery is not working. So therefore getting stuck mostly.
	- Wrong reasoning. Rotate nehaviour is workin.

ISSUE 22-
Oscillatory/circular behaviour of robot occuring where its moving around a goalpoint

To check this.

14/9/2020
Global planner is a more flexible version of navfn global planner.
navfn planner -
	- The planner assumes a circular robot and operates on a costmap to find a minimum cost plan from a start point to an end point in a grid. 

ISSUE 23 -
	- The robot gets stuck on the wall and no rotate recovery behaviour occurs.

Modified the global costmap inflation radius to 1. Local costmap inflation radius = 1
	- No movement as many narrow regions
Modified the global costmap inflation radius to 0.5. Local costmap inflation radius = 1
	- No ISSUE 23
	- ISSUE 22 still there
global costmap inflation radius =  0.5. Modified the local costmap inflation radius to 0.5.
	- No ISSUE 23
	- ISSUE 22 still there
Modified the global costmap inflation radius to 0.25. local costmap inflation radius = 0.5
	- ISSUE 23 occurs
	- ISSUE 22 also occurs
Modified the global costmap inflation radius = 0.3. local costmap inflation radius = 0.5
	- ISSUE 23 occurs
Modified the global costmap inflation radius = 0.3. local costmap inflation radius = 0.75
	- ISSUE 22 occurs
Modified the global costmap inflation radius = 0.3. local costmap inflation radius = 0.65
	- ISSUE 23 occurs
Modified the global costmap inflation radius = 0.3. local costmap inflation radius = 0.7
	- ISSUE 22 occurs
Modified the publish_frequency = 0.5
	- ISSUE 22 occurs
Modifed in global costmap param, the width=10, height=10 and resolution = 0.025
	- ISSUE 23 occurs
Removed in global costmap param, the width=10, height=10 and  kept resolution = 0.025
	- ISSUE 22 occurs
Removed in local costmap param, the width=5 height=5 and  kept resolution = 0.05
	- ISSUE 24 - Robot not moving as it fails to get a plan because the local planner not giving it a chance
Removed in local costmap param, the width=2 height=2 
	- ISSUE 24 occurs
Modifed local publish_frequency=5 
	- ISSUE 23 occurs
Modifed global publish_frequency=5 
	- ISSUE 23 occurs
	- Appears to be stuck in its local inflation region
Reduced local_costmap inflation to 0.5
	- ISSUE 24 occurs
Made allow_unknown = false
	- ISSUE 24 occurs

Need to Check the goal assignment by the assigner. Posibly this causing the Issue.	

It appears that when inflation radius is too large then ISSUE 22 occurs and when its too small ISSUE 23 occurs.

For RRT Exploration:-
In Filter->
-Frontiers (visualization_msgs/Marker)
	The topic on which the filter node publishes the received frontier points for visualiztion on Rviz.
-centroids (visualization_msgs/Marker)
	The topic on which the filter node publishes only the filtered frontier points for visualiztion on Rviz.
-filtered_points (invalid message type for MsgLink(msg/type))	
	All the filtered points are sent as an array of points to the assigner node on this topic.
	
-ISSUE 22.23.24 need to be tackled.
-Goal being given, but the global and local planner are screwed.

15/9/2020
Global Planner -> 
COST_NEUTRAL ->
COST_FACTOR -> 

- Shifted values to original for local and global costmap and planners and assigned the following:-

 cost_factor: 0.55
 neutral_cost: 66
 lethal_cost: 253
 
	- ISSUE 23 occurs
	- No ISSUE 22, 24
	- ISSUE 25 - Robot not localised properly. 
						It appears that the robot shifts from its original position a little which causes a path generated froma random point rather than the robot.
-Launched the file with default AMCL package.
	-ISSUE 26 - AMCL Aways stops
	-ISSUE 25 occurs
	-ISSUE 27 - Request for map occurs
	-The local planner appears to be issue.
	
-Launched without AMCL
	-ISSUE 25 occurs
	
16/9/2020
-Manually applied a goal position using move_base/goal. This caused ISSUE 25

-Questions -
-When are goals assigned to the robot?
-Why is the robot drifting away from the path planned by the global plan?
-Why is the robot plastering and getting stuck onto the wall? (ISSUE 23)

Applied inflation value = 1.75 and cost_scaling_factor = 2.58 to TEB local planner 
	- ISSUE 23
Applied inflation value = 1.75 and cost_scaling_factor = 2.58 to MPC local planner 
	- ISSUE 22

TBD in order:-
-TEB and MPC planner theory reading and then tuning. - from Masters thesis
-Goal Assignment using RRT exploration - From masters thesis
-Multiple move_base nodes
-DWA local planner to be implemented

17/9/2020
-Robot being used is a Differential Robot
- min_obstacle_dist 
	- Needed for acoiding obstacles.
	- Distances below this value lead to a non-zero cost. 

-Ran with cartographer
	- ISSUE 28 - The Gray'sh green area of the map/the initial detected map is too small (What is it?)
	- ISSUE 25 occurs when 
		-giving physical goals at unexplored (gray areas)
		-giving physical goals on the walls of the area

-ISSUE 29 - Currently with multinavrobot_arena_rrt.launch, the individual maps appear in another part of the arena
-ISSUE 30 - In global detected points, only points of one robot are displayed
	- Must check


18/9/2020	
-Filter module - 
	- Clusters frontier points using mean shift clustering and discards points not in center of cluster.
	- Removes old and invalid frontier points
- Robot Task Allocator
	- Navigation Cost (N) - Norm of difference b/w current loc and front loc
	- Information Gain (I) - Area of unknown region expected to be explored. Number of Cells*Area of each cell.
	- Market Based Assignment -
		- Revenue = lambda*I - N
		
19/9/2020
-ISSUE 31 - When an orientation of pi is given, spawning of the robot occurs but the merging does not occur and the individual maps are spaced out from one another.

<arg name="init_pose" value="-x 0 -y -0.8 -z 0" />

-To try out map_merge 3D
		
21/9/2020
- To counter ISSUE 22 and 23,
	-I gave a goal of 0.5m less in both X and Y dimensions, to stop getting a goal right at the wall.
	-I kept a counter of 10 and after 10 cycles of the assigner loop I am giving a fresh goal. Due to this the global planner resets and another goal is assigned to the robot. This done to remove any goals that mayybe given outside the area.
	
-ISSUE 32 - Robot is getting stuck at one of the goals and not moving from that position even though new point is assinged. It is dropping path to the goal.
	
22/9/2020
-ISSUE 33 - In the nav_robots seperate code, the laser scan of the robots is not getting coupled with the map (as in the previous code without sperates). Due to this individual map frames couple with the global map frame. But the lasers to not couple wiht global map frame.

moving to non seperate  move base and gmapping and trying 

23/9/2020
- Frontier Points on the wall are not getting removed/cleared and continue to remain there

- Can we somehow remove points on the wall?
- Can old points detected on the wall be cleared off?

In functions_algo_edit, changed map_topic to /map. This done as its correct entry is mportant for the filter module to check the validity of the received point. 
	- Much better performance. Does not get stuck and able to map the entire map.
	- However one of the points is still present on the wall.

Ran for 1 minute and analysed the perfomance again and found that shifitng the line frontiers = copy(centroids) after the clearing old frontiers gave a better performance. 
Images in 	/home/vibhav/Desktop/dobots/report/rrt.

Removed the counter of 5 and the 0.5 difference

Wehnever a goal is assigned to a wall, tISSUe 22 and 23 occur.



































